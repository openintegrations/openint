{
  "openapi": "3.1.0",
  "info": {
    "title": "OpenInt",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "http://localhost:3000"
    }
  ],
  "paths": {
    "/connection": {
      "get": {
        "operationId": "listConnections",
        "security": [
          {
            "Authorization": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "items": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/core.connection"
                      }
                    }
                  },
                  "required": [
                    "items"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Authorization not provided",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.UNAUTHORIZED"
                }
              }
            }
          },
          "403": {
            "description": "Insufficient access",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.FORBIDDEN"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.INTERNAL_SERVER_ERROR"
                }
              }
            }
          }
        }
      }
    },
    "/connector-config": {
      "get": {
        "operationId": "listConnectorConfigs",
        "security": [
          {
            "Authorization": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "items": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/core.connector_config"
                      }
                    }
                  },
                  "required": [
                    "items"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Authorization not provided",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.UNAUTHORIZED"
                }
              }
            }
          },
          "403": {
            "description": "Insufficient access",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.FORBIDDEN"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.INTERNAL_SERVER_ERROR"
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "operationId": "health",
        "security": [
          {
            "Authorization": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "401": {
            "description": "Authorization not provided",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.UNAUTHORIZED"
                }
              }
            }
          },
          "403": {
            "description": "Insufficient access",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.FORBIDDEN"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/error.INTERNAL_SERVER_ERROR"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "Authorization": {
        "type": "http",
        "scheme": "bearer"
      }
    },
    "schemas": {
      "connectors.greenhouse.connectionSettings": {
        "type": "object",
        "properties": {
          "connector_name": {
            "type": "string",
            "const": "greenhouse"
          },
          "settings": {
            "type": "object",
            "properties": {
              "apiKey": {
                "type": "string"
              }
            },
            "required": [
              "apiKey"
            ]
          }
        },
        "required": [
          "connector_name",
          "settings"
        ]
      },
      "connectors.greenhouse.connectorConfig": {
        "type": "object",
        "properties": {
          "connector_name": {
            "type": "string",
            "const": "greenhouse"
          },
          "config": {
            "type": "null"
          }
        },
        "required": [
          "connector_name",
          "config"
        ]
      },
      "connectors.plaid.connectionSettings": {
        "type": "object",
        "properties": {
          "connector_name": {
            "type": "string",
            "const": "plaid"
          },
          "settings": {
            "type": "object",
            "properties": {
              "itemId": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "accessToken": {
                "type": "string"
              },
              "institution": {},
              "item": {},
              "status": {},
              "webhookItemError": {
                "type": "null"
              }
            },
            "required": [
              "accessToken"
            ]
          }
        },
        "required": [
          "connector_name",
          "settings"
        ]
      },
      "connectors.plaid.connectorConfig": {
        "type": "object",
        "properties": {
          "connector_name": {
            "type": "string",
            "const": "plaid"
          },
          "config": {
            "type": "object",
            "properties": {
              "envName": {
                "type": "string",
                "enum": [
                  "sandbox",
                  "development",
                  "production"
                ]
              },
              "credentials": {
                "anyOf": [
                  {
                    "type": "null"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "clientId": {
                        "type": "string"
                      },
                      "clientSecret": {
                        "type": "string"
                      }
                    },
                    "required": [
                      "clientId",
                      "clientSecret"
                    ]
                  }
                ]
              },
              "clientName": {
                "type": "string",
                "maxLength": 30,
                "default": "This Application"
              },
              "products": {
                "type": "array",
                "items": {
                  "type": "string",
                  "enum": [
                    "assets",
                    "auth",
                    "balance",
                    "identity",
                    "investments",
                    "liabilities",
                    "payment_initiation",
                    "identity_verification",
                    "transactions",
                    "credit_details",
                    "income",
                    "income_verification",
                    "deposit_switch",
                    "standing_orders",
                    "transfer",
                    "employment",
                    "recurring_transactions"
                  ]
                },
                "default": [
                  "transactions"
                ]
              },
              "countryCodes": {
                "type": "array",
                "items": {
                  "type": "string",
                  "enum": [
                    "US",
                    "GB",
                    "ES",
                    "NL",
                    "FR",
                    "IE",
                    "CA",
                    "DE",
                    "IT",
                    "PL",
                    "DK",
                    "NO",
                    "SE",
                    "EE",
                    "LT",
                    "LV"
                  ]
                },
                "default": [
                  "US",
                  "CA"
                ]
              },
              "language": {
                "type": "string",
                "enum": [
                  "en",
                  "fr",
                  "es",
                  "nl",
                  "de"
                ],
                "default": "en"
              }
            },
            "required": [
              "envName",
              "clientName",
              "products",
              "countryCodes",
              "language"
            ]
          }
        },
        "required": [
          "connector_name",
          "config"
        ]
      },
      "core.connection": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "updated_at": {
                "type": "string",
                "format": "date-time"
              },
              "created_at": {
                "type": "string",
                "format": "date-time"
              },
              "connector_config_id": {
                "type": "string"
              }
            },
            "required": [
              "id",
              "updated_at",
              "created_at",
              "connector_config_id"
            ],
            "description": "Connection Base"
          },
          {
            "oneOf": [
              {
                "$ref": "#/components/schemas/connectors.greenhouse.connectionSettings"
              },
              {
                "$ref": "#/components/schemas/connectors.plaid.connectionSettings"
              }
            ],
            "discriminator": {
              "propertyName": "connector_name",
              "mapping": {
                "greenhouse": "#/components/schemas/connectors.greenhouse.connectionSettings",
                "plaid": "#/components/schemas/connectors.plaid.connectionSettings"
              }
            },
            "description": "Connector specific data"
          }
        ],
        "title": "Connection"
      },
      "core.connector_config": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "updated_at": {
                "type": "string",
                "format": "date-time"
              },
              "created_at": {
                "type": "string",
                "format": "date-time"
              },
              "org_id": {
                "type": "string"
              }
            },
            "required": [
              "id",
              "updated_at",
              "created_at",
              "org_id"
            ],
            "description": "Connector Config Base"
          },
          {
            "oneOf": [
              {
                "$ref": "#/components/schemas/connectors.greenhouse.connectorConfig"
              },
              {
                "$ref": "#/components/schemas/connectors.plaid.connectorConfig"
              }
            ],
            "discriminator": {
              "propertyName": "connector_name",
              "mapping": {
                "greenhouse": "#/components/schemas/connectors.greenhouse.connectorConfig",
                "plaid": "#/components/schemas/connectors.plaid.connectorConfig"
              }
            },
            "description": "Connector specific data"
          }
        ],
        "title": "Connector Config"
      },
      "error.FORBIDDEN": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "The error message",
            "example": "Insufficient access"
          },
          "code": {
            "type": "string",
            "description": "The error code",
            "example": "FORBIDDEN"
          },
          "issues": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "message": {
                  "type": "string"
                }
              },
              "required": [
                "message"
              ]
            },
            "description": "An array of issues that were responsible for the error",
            "example": []
          }
        },
        "required": [
          "message",
          "code"
        ],
        "title": "Insufficient access error (403)",
        "description": "The error information",
        "example": {
          "code": "FORBIDDEN",
          "message": "Insufficient access",
          "issues": []
        }
      },
      "error.INTERNAL_SERVER_ERROR": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "The error message",
            "example": "Internal server error"
          },
          "code": {
            "type": "string",
            "description": "The error code",
            "example": "INTERNAL_SERVER_ERROR"
          },
          "issues": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "message": {
                  "type": "string"
                }
              },
              "required": [
                "message"
              ]
            },
            "description": "An array of issues that were responsible for the error",
            "example": []
          }
        },
        "required": [
          "message",
          "code"
        ],
        "title": "Internal server error error (500)",
        "description": "The error information",
        "example": {
          "code": "INTERNAL_SERVER_ERROR",
          "message": "Internal server error",
          "issues": []
        }
      },
      "error.UNAUTHORIZED": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "The error message",
            "example": "Authorization not provided"
          },
          "code": {
            "type": "string",
            "description": "The error code",
            "example": "UNAUTHORIZED"
          },
          "issues": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "message": {
                  "type": "string"
                }
              },
              "required": [
                "message"
              ]
            },
            "description": "An array of issues that were responsible for the error",
            "example": []
          }
        },
        "required": [
          "message",
          "code"
        ],
        "title": "Authorization not provided error (401)",
        "description": "The error information",
        "example": {
          "code": "UNAUTHORIZED",
          "message": "Authorization not provided",
          "issues": []
        }
      }
    }
  }
}